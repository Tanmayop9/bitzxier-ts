# Friday Discord Bot - Setup Guide

## Quick Start

The easiest way to set up and run Friday Discord Bot is using the automated setup script.

### One-Command Setup

```bash
npm run setup
```

This single command will:
1. âœ… Check your environment configuration
2. âœ… Install all dependencies
3. âœ… Build TypeScript to JavaScript
4. âœ… Start the bot automatically

## Prerequisites

Before running setup, make sure you have:

- **Node.js** 14.13.0 or higher
- **NPM** or **Yarn** package manager
- **Git** (if cloning from repository)

## Initial Configuration

### 1. Clone the Repository (if not already done)

```bash
git clone https://github.com/Tanmayop9/soward-test.git
cd soward-test
```

### 2. Configure Environment

Create a `.env` file in the root directory:

```bash
cp .env.example .env
```

Edit `.env` with your bot credentials:

```env
TOKEN=your_discord_bot_token_here
ERROR_WEBHOOK_URL=your_error_webhook_url
RATELIMIT_WEBHOOK_URL=your_ratelimit_webhook_url
LOG_LEVEL=info
NODE_ENV=production
HEALTH_CHECK_PORT=3000
```

### 3. Configure Bot Settings

Make sure `config.json` exists with your bot configuration:

```json
{
    "TOKEN": "your_token",
    "owner": ["your_user_id"],
    "WEBHOOK_URL": "webhook_for_shards",
    "MONGO_DB": "mongodb_connection_string",
    "ERROR_WEBHOOK_URL": "error_webhook_url",
    "RATELIMIT_WEBHOOK_URL": "ratelimit_webhook_url"
}
```

## Running the Setup Script

### Method 1: Using NPM Script (Recommended)

```bash
npm run setup
```

### Method 2: Direct Execution

```bash
node setup.js
```

### Method 3: With Executable Permission

```bash
chmod +x setup.js
./setup.js
```

## What the Setup Script Does

### Step 1: Environment Check
- Verifies `.env` file exists
- Checks for `config.json`
- Provides warnings if files are missing

### Step 2: Dependency Installation
- Runs `npm install`
- Installs all production dependencies
- Installs TypeScript and development tools

### Step 3: TypeScript Build
- Compiles all `.ts` files to JavaScript
- Outputs compiled files to `dist/` directory
- Generates source maps for debugging

### Step 4: Bot Startup
- Starts the bot using compiled JavaScript
- Uses cluster manager for sharding
- Displays startup banner and logs

## Manual Setup (Alternative)

If you prefer to run commands manually:

```bash
# 1. Install dependencies
npm install

# 2. Build TypeScript
npm run build

# 3. Start the bot
npm start
```

## Development Mode

For development with automatic TypeScript compilation:

```bash
# Run with ts-node (no build required)
npm run dev

# Or watch mode (auto-rebuild on changes)
npm run watch
```

Then in another terminal:
```bash
npm start
```

## Troubleshooting

### Setup Script Fails at Dependency Installation

**Solution:**
```bash
# Clear npm cache
npm cache clean --force

# Delete node_modules and try again
rm -rf node_modules package-lock.json
npm run setup
```

### TypeScript Build Fails

**Solution:**
```bash
# Check TypeScript errors
npm run typecheck

# Try building manually
npm run build
```

### Bot Won't Start

**Common Issues:**

1. **Missing .env file**
   - Copy `.env.example` to `.env`
   - Add your bot token

2. **Missing config.json**
   - Create `config.json` with required fields
   - See configuration section above

3. **Port already in use**
   - Change `HEALTH_CHECK_PORT` in `.env`
   - Or disable health check

4. **Invalid token**
   - Verify your Discord bot token
   - Check token in `.env` or `config.json`

### Setup Script Doesn't Stop

**Solution:**
Press `Ctrl+C` to gracefully stop the bot

## Scripts Reference

All available npm scripts:

```bash
npm run setup        # Run full setup and start bot
npm run build        # Compile TypeScript to JavaScript
npm start            # Start the bot (requires build first)
npm run dev          # Run in development mode with ts-node
npm run watch        # Watch and rebuild on changes
npm run typecheck    # Check TypeScript types without building
npm run lint         # Check code style
npm run lint:fix     # Fix code style issues
npm run format       # Format code with Prettier
```

## Directory Structure After Setup

```
friday-bot/
â”œâ”€â”€ dist/              # Compiled JavaScript (generated by setup)
â”‚   â”œâ”€â”€ commands/      # Compiled command files
â”‚   â”œâ”€â”€ events/        # Compiled event handlers
â”‚   â”œâ”€â”€ structures/    # Compiled core classes
â”‚   â”œâ”€â”€ index.js       # Compiled entry point
â”‚   â””â”€â”€ shards.js      # Compiled cluster manager
â”œâ”€â”€ commands/          # TypeScript source files
â”œâ”€â”€ events/
â”œâ”€â”€ structures/
â”œâ”€â”€ types/
â”œâ”€â”€ logs/
â”œâ”€â”€ models/
â”œâ”€â”€ .env              # Your environment config
â”œâ”€â”€ config.json       # Bot configuration
â”œâ”€â”€ setup.js          # Setup script
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

## Production Deployment

For production servers:

1. **Run Setup Once**
   ```bash
   npm run setup
   ```

2. **Use Process Manager**
   ```bash
   # Install PM2
   npm install -g pm2
   
   # Start with PM2
   pm2 start dist/shards.js --name friday-bot
   
   # Make it restart on reboot
   pm2 startup
   pm2 save
   ```

3. **Monitor Logs**
   ```bash
   pm2 logs friday-bot
   ```

## Updating the Bot

When you pull new changes:

```bash
# Pull latest changes
git pull

# Re-run setup to rebuild and restart
npm run setup
```

Or manually:
```bash
git pull
npm install
npm run build
npm start
```

## Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `TOKEN` | Discord bot token | Yes | - |
| `NODE_ENV` | Environment (development/production) | No | production |
| `LOG_LEVEL` | Logging level | No | info |
| `HEALTH_CHECK_PORT` | Health check server port | No | - |
| `ERROR_WEBHOOK_URL` | Error reporting webhook | No | - |
| `RATELIMIT_WEBHOOK_URL` | Rate limit webhook | No | - |

## Support

If you encounter issues with setup:

1. Check this guide thoroughly
2. Review error messages carefully
3. Check the [TYPESCRIPT_CONVERSION.md](./TYPESCRIPT_CONVERSION.md) guide
4. Verify your Node.js version: `node --version`
5. Ensure all config files are properly set up

## Advanced Options

### Skip Dependency Installation

If dependencies are already installed:
```bash
# Edit setup.js and comment out installDependencies()
# Or just run:
npm run build && npm start
```

### Custom Build Configuration

Edit `tsconfig.json` to customize TypeScript compilation options.

### Development with Live Reload

```bash
# Terminal 1: Watch and rebuild
npm run watch

# Terminal 2: Use nodemon for auto-restart
npm install -g nodemon
nodemon dist/shards.js
```

---

## Credits

- **Author**: Tanmay
- **Recoded by**: Nerox Studios
- **Version**: v2-alpha-1

**Happy Hosting! ðŸš€**
